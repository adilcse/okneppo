# Load nvm if available
if [ -s "$HOME/.nvm/nvm.sh" ]; then
  export NVM_DIR="$HOME/.nvm"
  . "$HOME/.nvm/nvm.sh"
  
  # Use Node.js 22.15.0 for the build
  echo "ğŸ’¡ Using Node.js v22.15.0 for the build..."
  nvm use 22.15.0 || (echo "âš ï¸ Failed to use Node.js v22.15.0, please install it using 'nvm install 22.15.0'" && exit 1)
  
  # Install dependencies
  echo "ğŸ“¦ Installing dependencies..."
  npm install || (echo "âŒ Dependencies installation failed! Push aborted." && exit 1)

  # Run the build
  echo "ğŸ—ï¸  Running build before push..."
  npm run build || (echo "âŒ Build failed! Push aborted." && exit 1)
  
  echo "âœ… Build successful! Proceeding with push."
else
  echo "âš ï¸ nvm not found. Please run build manually using 'nvm use 22.15.0 && npm run build' before pushing."
  exit 1
fi 